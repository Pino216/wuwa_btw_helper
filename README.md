# 鸣潮·踏潮探历算法助手 🤖

一个专为《鸣潮》游戏内"踏潮探历"活动设计的智能决策工具，通过多种算法策略帮助玩家以最优方式完成7×7坐标网格探索。

## ✨ 核心特性

### 🎯 智能算法引擎
- **贪心算法（利益至上）**：直接最大化当前点击的期望收益
- **带权启发（战略布局）**：平衡探索与利用，可动态调整探索权重
- **熵减算法（风险对冲）**：优先清理孤立格子，减少分散风险
- **综合推荐（算法融合）**：结合多种算法结果进行综合评分
- **权重自动调整**：带权启发算法的权重可根据游戏阶段自动动态变化

### 🔧 高级功能
- **软保底系统**：模拟游戏保底机制，当连续X次未触发事件时概率逐步提升，Y次后必触发非类型1事件
- **批量模拟分析**：运行数千次模拟，对比不同算法的平均点击次数和方差
- **热力分布图**：可视化展示开局最优解分布
- **实时概率调整**：根据保底计数动态调整7种事件类型的触发概率
- **算法综合配置**：可自定义参与综合推荐的算法组合

### 📱 用户体验
- **响应式设计**：完美适配桌面端和移动端，针对不同屏幕尺寸优化布局
- **智能折叠面板**：移动端自动折叠配置面板，为网格提供更多显示空间
- **直观可视化**：红/橙颜色标记最优和次优选择，绿色边框标记多算法推荐
- **本地存储**：自动保存游戏进度和所有设置
- **音效反馈**：Web Audio API提供操作音效增强沉浸感
- **移动端优化**：全宽长方形按钮、触摸友好的交互设计

## 🚀 快速开始

### 基本使用
1. **打开工具**：双击 `鸣潮踏潮探历小助手.html` 在浏览器中打开
2. **开始探索**：点击7×7网格中的任意未开启格子
3. **选择事件**：从弹出菜单中选择要触发的事件类型（1-7）
4. **跟随推荐**：
   - 🔴 **红色格子**：算法推荐的最优选择
   - 🟠 **橙色格子**：次优选择（分数 > 最优分数的80%）

### 配置说明
- **概率权重**：调整7种事件类型的触发概率（总和建议100%）
- **保底设置**：
  - 启用/禁用保底系统
  - 设置保底起始值（X）和上限值（Y）
  - 默认：起始3次，上限5次必触发非类型1事件
- **算法选择**：
  - 手动选择固定算法（贪心、带权启发、熵减、综合推荐）
  - 带权启发算法支持权重自动调整开关
  - 综合推荐算法可自定义参与计算的算法组合
- **布局控制**：
  - 桌面端：侧边栏可折叠，节省屏幕空间
  - 移动端：配置面板默认折叠，点击"显示设置"展开

### 批量模拟
1. 在侧边栏设置模拟次数（10-10000次）
2. 点击"开始批量模拟"
3. 查看对比结果：
   - 平均点击次数、方差、标准差
   - 开局热力分布图

## 🧠 算法深度解析

### 事件类型与收益计算
工具计算7种事件类型的期望收益：
1. **仅当前格子** 📍 - 基础收益
2. **同列所有格子** ↕️ - 列收益
3. **同行所有格子** ↔️ - 行收益
4. **同行同列** ➕ - 行列组合收益
5. **十字区域** 💠 - 四连通收益
6. **九宫格区域** 🍷 - 八连通收益
7. **全图开启** 🌟 - 全局收益

### 软保底机制实现
- **计数规则**：仅当触发类型1事件时，未触发计数增加
- **概率调整**：当计数≥X时，类型1概率逐步减少，其他类型概率按比例增加
- **必触发保证**：当计数达到Y时，必触发类型2-7中的一种事件

### 权重自动调整策略
带权启发算法支持权重自动调整功能，根据游戏阶段智能调整探索权重：
- **前期**（>30格）：权重较高（1.5-2.0），注重探索未开启区域
- **中期**（10-30格）：权重适中（1.0-1.5），平衡探索与利用
- **后期**（<10格）：权重较低（0.5-1.0），更注重直接收益

### 响应式布局设计
- **桌面端**：
  - 侧边配置面板固定定位，网格区域自适应
  - 圆形折叠按钮位于面板右侧，节省空间
  - 最大高度限制，支持滚动查看所有配置项
  
- **移动端**：
  - 垂直布局：网格在上，配置面板在下
  - 配置面板默认折叠，点击全宽长方形按钮展开
  - 网格使用`aspect-ratio`保持正方形，自适应屏幕宽度
  - 超小屏幕（<360px）进一步优化字体和间距

## 🛠️ 技术架构

### 核心技术栈
- **前端框架**：纯原生HTML5/CSS3/JavaScript
- **状态管理**：localStorage持久化存储
- **音频系统**：Web Audio API动态生成音效
- **响应式布局**：CSS媒体查询+Flexbox/Grid布局

### 核心数据结构
```javascript
const state = {
    grid: Array(49).fill(false),      // 7×7网格状态（true=已开启）
    probs: [33, 14, 14, 7, 18, 13, 1], // 7种事件概率权重
    clicks: 0,                         // 当前点击次数
    enablePity: true,                  // 保底系统开关
    pityStart: 3,                      // 保底起始计数X
    pityMax: 5,                        // 保底上限计数Y
    currentMisses: 0,                  // 当前未触发计数
    currentAlgorithm: 'greedy',        // 当前使用算法
    heuristicWeight: 1.0,              // 启发式算法权重
    autoAlgorithm: false               // 是否启用自动切换
};
```

### 文件结构
```
项目根目录/
├── index.html    # 主程序文件（单文件应用）
├── README.md                  # 项目说明文档
└── .gitignore                 # Git忽略配置
```

## 📈 使用策略建议

### 不同阶段的最佳实践
- **开局阶段**（剩余40+格）：
  - 使用动态切换或带权启发算法
  - 探索权重设为1.5-2.0
  - 关注热力分布图的高频区域
  
- **中期阶段**（剩余15-40格）：
  - 根据格子分布选择算法
  - 如孤立格子多（>30%）使用熵减算法
  - 否则使用贪心算法最大化收益
  
- **收尾阶段**（剩余<15格）：
  - 强制使用熵减算法
  - 优先清理邻居少的孤立格子
  - 关注保底计数，利用概率提升

### 保底系统优化
- 根据游戏实际设置合适的X/Y值
- 默认X=3,Y=5已针对活动优化
- 可通过批量模拟测试不同保底参数的效果

## ❓ 常见问题

### 概率权重相关问题
**Q: 概率权重总和不是100%可以吗？**  
A: 可以，程序会自动归一化处理，但建议设为100%以获得直观效果。

**Q: 如何重置概率权重？**  
A: 点击"重置进度"按钮，或手动修改输入框数值。

### 算法相关问题
**Q: 为什么贪心算法表现最好？**  
A: 在多数情况下，直接最大化当前收益是最有效的策略。带权启发和熵减算法在特定场景（如大量孤立格子）下可能表现更优。

**Q: 权重自动调整如何工作？**  
A: 当开启权重自动调整时，系统会根据当前游戏阶段（前期、中期、后期）自动调整带权启发算法的探索权重值。

**Q: 综合推荐算法如何选择参与算法？**  
A: 在综合推荐模式下，可以勾选参与计算的算法（贪心、带权启发、熵减），系统会计算这些算法的平均分数。

### 布局与界面问题
**Q: 在手机上配置面板为什么默认折叠？**  
A: 为了在移动端提供更大的网格显示空间，配置面板默认折叠。点击"显示设置"按钮即可展开。

**Q: 如何切换桌面端和移动端布局？**  
A: 布局会根据屏幕宽度自动切换。桌面端（宽度>768px）使用左右布局，移动端使用上下布局。

**Q: 移动端的切换按钮为什么是长方形？**  
A: 长方形按钮提供更大的触摸区域，并可以显示完整文字（"显示设置"/"隐藏设置"），提高移动端操作便利性。

### 技术问题
**Q: 数据存储在哪里？**  
A: 所有数据存储在浏览器的localStorage中，清除浏览器数据会丢失进度。

**Q: 支持移动设备吗？**  
A: 完全支持！工具采用响应式设计，在手机和平板上均可正常使用，并针对移动端进行了专门优化。

**Q: 需要网络连接吗？**  
A: 不需要，所有功能均在本地运行，打开HTML文件即可使用。

## 🔄 更新日志

### v1.4 (最新)
- **权重自动调整**：为带权启发算法添加权重自动调整开关
- **移动端布局优化**：全面改进移动端响应式设计
- **按钮样式改进**：移动端切换按钮从圆形改为全宽长方形
- **智能折叠逻辑**：移动端默认折叠配置面板，提供更大网格显示空间
- **综合算法增强**：改进算法综合评分机制

### v1.3
- **算法优化**：改进启发式和熵减算法计算逻辑
- **动态切换增强**：添加滞后区间避免频繁切换
- **保底系统修复**：确保达到上限时必触发非类型1事件
- **界面改进**：优化移动端显示和交互体验

### v1.2
- **算法重命名**：将"带权启发式"改为"带权启发"
- **显示修复**：修复动态切换算法在模拟结果中的显示问题
- **性能优化**：改进批量模拟执行效率

### v1.1
- **多算法支持**：添加三种核心算法
- **批量模拟**：引入统计分析和热力图
- **保底系统**：实现软保底概率调整机制

### v1.0
- **基础版本**：7×7网格交互
- **贪心算法**：基础期望收益计算
- **本地存储**：进度自动保存

## 🤝 贡献与支持

### 开发团队
本项目由 **B站@Dark噫术家** 独立开发维护。

### 问题反馈
如遇到问题或有改进建议：
1. 检查[常见问题](#-常见问题)部分
2. 通过GitHub Issues提交问题报告
3. 在B站联系作者获取支持

### 贡献指南
欢迎提交Pull Request改进：
- 算法优化建议
- 界面改进方案
- 文档完善
- Bug修复

## 📄 许可证

本项目采用 **学习交流许可证**：
- 可自由使用、修改、分发
- 禁止用于商业用途
- 保留原作者署名
- 不提供任何担保

---

**🎮 探索无限可能，算法助你踏潮前行！**  
*祝各位潮友在《鸣潮》的踏潮探历活动中高效探索，收获满满！*

> 提示：游戏活动规则可能调整，建议根据实际情况微调算法参数。
